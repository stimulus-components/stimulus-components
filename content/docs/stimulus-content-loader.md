---
title: Content Loader
description: A Stimulus controller to asynchronously load HTML from an url.
package: content-loader
netlify_id: bc6c7113-e3e7-4d1f-9508-4b631eea2e70
---

## Video Tutorial

[Dave Kimura](https://twitter.com/kobaltz) from [Drifting Ruby](https://www.driftingruby.com/) has released a presentation video on how to use this package with a real life example.

üëâ Take a look: [Deferred Content Loading](https://www.driftingruby.com/episodes/deferred-content-loading)

<Youtube id="kZircHj1KI0"></Youtube>

## Installation

```bash
$ yarn add stimulus-content-loader
```

And use it in your JS file:

```js
// Probably in app/javascript/controllers/index.js

import { Application } from '@hotwired/stimulus'
import ContentLoader from 'stimulus-content-loader'

const application = Application.start()
application.register('content-loader', ContentLoader)
```

<DocsDemoLink package-name="content-loader"></DocsDemoLink>

## Usage

In your controller:

```ruby
class PostsController < ApplicationController
  def comments
    render partial: 'posts/comments', locals: { comments: @post.comments }
  end
end
```

In your routes:

```ruby
Rails.application.routes.draw do
ressources
  get :comments, to: 'posts#comments'
end
```

In your view:

```erb
<div data-controller="content-loader" data-content-loader-url-value="<%= comments_path %>">
  <i class="fas fa-spinner fa-spin"></i>
  Loading comments... This content will be replaced by the content of the `posts/comments` partial generated by Rails.
</div>

<div
  data-controller="content-loader"
  data-content-loader-url-value="<%= comments_path %>"
  data-content-loader-refresh-interval-value="5000"
>
  This content will be reloaded every 5 seconds.
</div>

<div
  data-controller="content-loader"
  data-content-loader-url-value="/message.html"
  data-content-loader-load-scripts-value="true"
>
  This content will be replaced by the content of the `/message.html` page in your public folder.
</div>

<div
  data-controller="content-loader"
  data-content-loader-url-value="/message.html"
  data-content-loader-lazy-loading-value=""
>
  This content will be replaced only when the element become visible thanks to Intersection Observers.
</div>

<div
  data-controller="content-loader"
  data-content-loader-url-value="/message.html"
  data-content-loader-lazy-loading-value=""
  data-content-loader-lazy-loading-root-margin-value="30px"
  data-content-loader-lazy-loading-threshold-value="0.4"
>
  You can customize the Intersection Observer options.
</div>

<div
  data-controller="content-loader"
  data-content-loader-url-value="/message.html"
  data-content-loader-lazy-loading-value=""
  data-content-loader-refresh-interval-value="5000"
>
  You can combine lazy loading and refresh interval. The timer will start only after the first fetch.
</div>
```

## üõ† Configuration

| Attribute                                            | Default     | Description                                  | Optional |
| ---------------------------------------------------- | ----------- | -------------------------------------------- | -------- |
| `data-content-loader-url-value`                      | `undefined` | URL to fetch the content.                    | ‚ùå       |
| `data-content-loader-refresh-interval-value`         | `undefined` | Interval in milliseconds to reload content.  | ‚úÖ       |
| `data-content-loader-lazy-loading-value`             | `undefined` | Fetch content when element is visible.       | ‚úÖ       |
| `data-content-loader-lazy-loading-root-margin-value` | `0px`       | rootMargin option for Intersection Observer. | ‚úÖ       |
| `data-content-loader-lazy-loading-threshold-value`   | `0`         | threshold option for Intersection Observer.  | ‚úÖ       |
| `data-content-loader-load-scripts-value`             | `false`     | Load inline scripts from the content.        | ‚úÖ       |

## üéõ Extending Controller

<DocsExtendingController>

```js
import ContentLoader from 'stimulus-content-loader'

export default class extends ContentLoader {
  connect() {
    super.connect()
    console.log('Do what you want here.')
  }
}
```

</DocsExtendingController>

## Credits

This controller is inspired by the [official Stimulus example](https://stimulus.hotwired.dev/handbook/working-with-external-resources).
